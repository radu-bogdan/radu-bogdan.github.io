<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Roll shift visualizer</title>
  <!-- Plotly now loaded on-demand (scatter-only custom build) -->
    <script type="module" crossorigin src="/primetals/crownvis/assets/index-Ck4MmW96.js"></script>
    <link rel="stylesheet" crossorigin href="/primetals/crownvis/assets/index-Bl9bReIx.css">
  </head>
  <body>
    <main class="app">
      <!-- <header>
        <h1>Roll shift visualizer</h1>
      </header> -->

      <section class="panel card panel--split">
        <div class="panel-left">
          <!-- IMPORTANT: Plotly uses a DIV, not SVG -->
          <div id="plot"></div>

          <div class="controls card controls--bottom">
            <div class="row row--compact">
              <label for="shift">Shift (m)</label>
              <input id="shift" type="range" min="-0.4" max="0.4" step="0.001" />
            </div>
            <div class="row row--compact">
              <label for="vshift">Vertical shift (m)</label>
              <input id="vshift" type="range" min="-0.001" max="0.001" step="0.00001" />
            </div>

            <div class="meta">
              <span class="badge" id="crown">Shift = <strong id="crownMM" >0.00</strong> mm</span>
              <span class="badge" id="vbadge">VShift = <strong id="vshiftMM">0.00</strong> mm</span>
              <span class="badge" id="crownFormula">crown = <strong id="crownVal">—</strong> µm</span>
              <span class="badge">x ∈ [−1, 1], N = <span id="npts"></span></span>
            </div>
          </div>
        </div>

        <div class="coeffs card">
          <h2 class="coeffs__title">Coefficients</h2>
          <div class="coeff">
            <label for="a1">a₁ (linear)</label>
            <input id="a1" type="text" inputmode="decimal" />
          </div>
          <div class="coeff">
            <label for="a2">a₂ (quadratic)</label>
            <input id="a2" type="text" inputmode="decimal" />
          </div>
          <div class="coeff">
            <label for="a3">a₃ (cubic)</label>
            <input id="a3" type="text" inputmode="decimal" />
          </div>
          <div class="coeff">
            <label for="a4">a₄ (quartic)</label>
            <input id="a4" type="text" inputmode="decimal" />
          </div>
          <div class="help-btn-wrap">
            <button id="flipPairBtn" type="button" class="help-btn" title="Flip OS-DS">Flip</button>
            <button id="resetCoeffsBtn" type="button" class="help-btn" title="Reset coefficients to session start">Reset</button>
            <button id="tokenCoeffsBtn" type="button" class="help-btn" title="Reset to hardcoded defaults">Default</button>
          </div>
          <div class="help-btn-wrap" style="margin-top:4px; align-items:center; display:flex; gap:8px;">
            <label style="font-size:12px; display:flex; align-items:center; gap:6px; cursor:pointer;">
              <input id="fixShiftChk" type="checkbox" title="Keep current shift when editing coefficients"/> Fix shift
            </label>
            <!-- <span style="font-size:11px; color:var(--muted);">(Keep current shift when editing coefficients)</span> -->
          </div>
          <div class="poly-plot-wrap">
            <h3 class="mini-title">Diameter Top Roll (m)</h3>
            <div id="polyPlot"></div>
          </div>
          <div class="help-btn-wrap">
            <button id="helpBtn" type="button" class="help-btn" title="Usage & formulas">Usage / Formulas</button>
          </div>
        </div>
        </div>
      </section>
    </main>

    <footer class="app-footer">
      <label class="debug-toggle"><input id="darkToggle" type="checkbox" /> Dark mode</label>
      <label class="debug-toggle"><input id="debugToggle" type="checkbox" /> Bogdan's layer</label>
    </footer>

  <!-- MathJax now lazy-loaded only when help popup opens -->
  </body>
</html>